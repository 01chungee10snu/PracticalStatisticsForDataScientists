이 장에서는 소규모 심리 척도 데이터를 활용하여 직접 요인 분석의 절차를 단계별로 보여 줍니다. 예제 데이터의 상관 행렬을 계산하고 행렬 분해를 통해 요인 부하량을 추정한 뒤, 각 요인이 설명하는 분산 비율을 해석합니다. 실습을 통해 직접 요인 분석의 핵심 개념을 체감할 수 있습니다.

### 핵심 포인트
* 직접 요인 분석은 상관 행렬을 바로 분해해 요인을 추정합니다.
* 공통성 추정을 위해 최대 우도법이나 주축 요인법을 사용할 수 있습니다.
* 요인 수 결정 시 카이제르 기준과 스크리 플롯을 함께 검토합니다.

### 분석 절차
1. 데이터의 적합성을 확인하기 위해 KMO와 Bartlett 검정을 수행합니다.
2. 상관 행렬을 분해해 초기 요인 부하량을 계산합니다.
3. 필요하면 요인 회전을 적용해 해석의 명료성을 높입니다.
4. 요인 점수를 계산해 각 개인의 잠재 특성을 수량화하고 결과 해석과 비교합니다.

### 단계별 해석 팁
* 요인 수 결정 단계에서 스크리 플롯을 활용할 때 기울기 변화가 완만한 영역을 집중적으로 확인합니다.
* 회전 후에는 패턴 행렬과 구조 행렬을 나란히 제시하여 변수와 요인 간 관계를 명확히 합니다.

### 대학원 수준 심화
* 샘플 수가 적을 때는 평행 분석을 통해 요인 수를 추가로 검증합니다.
* 교차 검증 기법을 활용해 추정된 요인의 안정성과 재현 가능성을 평가합니다.
* 회전 결과를 해석할 때 패턴 행렬과 구조 행렬의 차이를 함께 살펴봅니다.

### 추가 학습 내용
* 요인 수 결정 과정에서 병렬 분석을 코드로 구현해 봅니다.
* 회전 방법별로 부하량 패턴이 어떻게 달라지는지 그래프로 비교합니다.
* 분석 결과의 신뢰 구간을 부트스트랩으로 추정하는 절차를 시도합니다.

### 논문 수준 보충
* 분석 예시에서 사용된 데이터 전처리 단계를 상세히 기록합니다.
* 요인 수 결정 기준으로서 스크리 플롯 이외에 MAP 기준을 함께 설명합니다.
* 부트스트랩 요인 분석의 반복 횟수 선택 근거를 논문 사례와 비교합니다.

### 역사적 배경
* 초기 요인 분석 연구들은 소규모 데이터셋을 활용해 개념을 검증하는 데 집중했습니다.
## 실습 코드 예시
```python
from modules.data_processing import sample_public_dataset
import numpy as np

df = sample_public_dataset(50)
sample_var = np.var(df['sepal_length'])
print('표본 분산:', sample_var)
```

### 간단한 분석 코드 예시
```python
import pandas as pd
from sklearn.decomposition import FactorAnalysis

df = sample_public_dataset(100)
fa = FactorAnalysis(n_components=2, random_state=42)
factors = fa.fit_transform(df[['sepal_length', 'sepal_width', 'petal_length', 'petal_width']])
loadings = pd.DataFrame(fa.components_.T, columns=['Factor1', 'Factor2'])
```
`loadings`에는 각 요인이 변수에 미치는 영향을 나타내는 부하량이 저장됩니다. 이를 통해 어떤 변수들이 공통된 요인으로 묶이는지 해석할 수 있습니다.



### 추가 예시
- 요인 분석 계산을 스프레드시트와 파이썬으로 비교해 보는 실습을 권장합니다.
더 자세한 통합 요약은 [overview.md](../overview.md)에서 확인할 수 있습니다.
